<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
</head>
<body>

<div th:fragment="navbar">

  <!-- Desktop -->
  <nav class="bg-blue-800 text-white w-64 h-screen p-5 hidden md:flex flex-col fixed z-40">

    <div sec:authorize="isAuthenticated()" class="flex flex-col items-center mb-6">
      <div class="w-16 h-16 rounded-full bg-blue-600 flex items-center justify-center font-bold text-2xl mb-2 border-2 border-blue-400">
        <span th:text="${#strings.substring(#authentication.principal.username, 0, 1).toUpperCase()}">U</span>
      </div>
      <p class="text-sm font-semibold text-gray-200">
        ¡Hola, <span sec:authentication="principal.username"></span>!
      </p>
    </div>

    <div sec:authorize="!isAuthenticated()" class="mb-10 text-center">
      <h1 class="text-3xl font-extrabold text-blue-100">Gestión</h1>
    </div>

    <ul class="flex-grow space-y-4">
      <li>
        <a href="/index" class="flex items-center space-x-3 text-gray-200 hover:text-white hover:bg-blue-700 p-3 rounded-lg transition duration-200">
          <i class="fas fa-home"></i>
          <span>Inicio</span>
        </a>
      </li>
      <li>
        <a href="/clientes" class="flex items-center space-x-3 text-gray-200 hover:text-white hover:bg-blue-700 p-3 rounded-lg transition duration-200">
          <i class="fas fa-users"></i>
          <span>Clientes</span>
        </a>
      </li>
      <li>
        <a href="/proveedores" class="flex items-center space-x-3 text-gray-200 hover:text-white hover:bg-blue-700 p-3 rounded-lg transition duration-200">
          <i class="fas fa-truck-fast"></i>
          <span>Proveedores</span>
        </a>
      </li>
      <li>
        <a href="/productos" class="flex items-center space-x-3 text-gray-200 hover:text-white hover:bg-blue-700 p-3 rounded-lg transition duration-200">
          <i class="fas fa-box-open"></i>
          <span>Productos</span>
        </a>
      </li>
      <li>
        <a href="/ventas" class="flex items-center space-x-3 text-gray-200 hover:text-white hover:bg-blue-700 p-3 rounded-lg transition duration-200">
          <i class="fas fa-shopping-cart"></i>
          <span>Ventas</span>
        </a>
      </li>

    </ul>

    <div class="mt-auto">
      <form th:action="@{/logout}" method="post">
        <button type="submit" class="w-full flex items-center space-x-3 text-red-400 hover:text-red-300 p-3 rounded-lg transition duration-200">
          <i class="fas fa-sign-out-alt"></i>
          <span>Cerrar sesión</span>
        </button>
      </form>
    </div>
  </nav>

  <!-- Mobile -->
  <div class="md:hidden">
    <!-- Botón hamburguesa fijo arriba -->
    <button id="mobile-menu-btn"
            class="fixed top-4 left-4 z-50 p-2 bg-blue-800 text-white rounded-lg shadow-lg">
      <i class="fas fa-bars text-xl"></i>
    </button>

    <!-- Menú móvil lateral -->
    <div id="mobile-menu"
         class="fixed top-0 left-0 h-full w-64 bg-blue-800 text-white p-4 space-y-3 shadow-lg transform -translate-x-full transition-transform duration-300 ease-in-out z-40">

      <div sec:authorize="isAuthenticated()" class="flex flex-col items-center mb-6">
        <div class="w-16 h-16 rounded-full bg-blue-600 flex items-center justify-center font-bold text-2xl mb-2 border-2 border-blue-400">
          <span th:text="${#strings.substring(#authentication.principal.username, 0, 1).toUpperCase()}">U</span>
        </div>
        <p class="text-sm font-semibold text-gray-200">
          ¡Hola, <span sec:authentication="principal.username"></span>!
        </p>
      </div>

      <a href="/index" class="block p-2 rounded-lg hover:bg-blue-600 transition duration-200">Inicio</a>
      <a href="/clientes" class="block p-2 rounded-lg hover:bg-blue-600 transition duration-200">Clientes</a>
      <a href="/proveedores" class="block p-2 rounded-lg hover:bg-blue-600 transition duration-200">Proveedores</a>
      <a href="/productos" class="block p-2 rounded-lg hover:bg-blue-600 transition duration-200">Productos</a>
      <a href="/ventas" class="block p-2 rounded-lg hover:bg-blue-600 transition duration-200">Ventas</a>


      <form th:action="@{/logout}" method="post" class="pt-2">
        <button type="submit" class="w-full text-left text-red-400 hover:text-red-300 p-2 rounded-lg hover:bg-blue-600 transition duration-200">
          Cerrar sesión
        </button>
      </form>
    </div>
  </div>

</div>

<!-- Script toggle -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const btn = document.getElementById('mobile-menu-btn');
    const menu = document.getElementById('mobile-menu');

    btn.addEventListener('click', () => {
      menu.classList.toggle('translate-x-0');
      menu.classList.toggle('-translate-x-full');
    });
  });
</script>

</body>
</html>
